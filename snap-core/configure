#!/usr/bin/sh
set -e

rm -f src.mk || true
/usr/bin/printf "\xa\x23 Generated by configure. \xa" > src.mk

/usr/bin/printf 'LIBSNAP_CXX = \x5c\xa' >> src.mk
# grep -v "Snap" excludes Snap.cpp and testSnap.cpp to avoid duplicate inclusion
for f in $( ls *.cpp ../glib-core/*.cpp | grep -v "Snap" ); do
    /usr/bin/printf "\x9%s \x5c\xa" $f >> src.mk
done
/usr/bin/printf "\xa\xa" >> src.mk

/usr/bin/printf 'LIBSNAP_HXX = \x5c\xa' >> src.mk
for f in $( ls *.h ../glib-core/*.h ); do
    /usr/bin/printf "\x9%s \x5c\xa" $f >> src.mk
done
/usr/bin/printf "\xa\xa" >> src.mk

/usr/bin/printf 'LIBSNAP_OBJS = \x5c\xa' >> src.mk
for f in $( ls *.cpp ../glib-core/*.cpp | grep -v "Snap" ); do
    obj=$( printf $f | sed "s/.cpp/.o/" )
    /usr/bin/printf "\x9%s \x5c\xa" $obj >> src.mk
done
/usr/bin/printf "\xa\xa" >> src.mk
